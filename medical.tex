% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[12pt]{article} % use larger type; default would be 10pt
\usepackage{color}
\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS

%\usepackage[top=20mm,right=20mm,bottom=15mm,left=20mm]{geometry}
% \geometry{margins=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
%\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)

%\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{float}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{color}

% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
%\usepackage{sectsty}
%\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
%\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
%\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
%\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
%\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!


\newtheorem{theorem}{Theorem} 
\newtheorem{lemma}{Lemma}
\newtheorem{propn}{Proposition}
\newtheorem*{thmm}{Theorem}
\newtheorem{remk}{Remark} 
\newtheorem{corol}{Corollary}
\newtheorem{definition}{Definition}



\newtheorem{thm}{Theorem}[section] 
\newtheorem{prop}[thm]{Proposition} 
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary} 
\newtheorem{con}[thm]{Conjecture} 

\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem*{rem}{Remark}
%\newtheorem*{nota}{Notation}
\newtheorem*{nota}{Notation}
\newtheorem{cla}[thm]{Claim}
\newtheorem{ex}[thm]{Example}
\newtheorem{exs}[thm]{Examples}
\newtheorem*{exer}{Exercise}
\newtheorem{case}{Case}

\definecolor{sotonblue}{rgb}{0.0,0.394,0.597}
%opening
\title{Some probabilities}
\author{David Matthews}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\Vol}{Vol}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\lv}{lv}
\DeclareMathOperator{\p}{\text{Pr\"{u}fer}}
\DeclareMathOperator{\m}{m}

%to do
%Be more careful with the tikz 
%Put references in later
%define a binary tree
\begin{document}

\title{Symmetry and CAA}
\author{David Matthews}

\section{Introduction}\label{sec:intro}
%leaves???
\emph{Alzheimer's disease} (AD) is a debilitating medical condition characterised by serious and progressive cognitive decline that affects one in eight people over 65 years of age \cite{Bengt}. Alzheimer's disease is the most common dementia and appears to be due to a failure of elimination of amyloid-$\beta$ (A$\beta$) - a normal by-product of cell metabolism %produced at an approximately constant rate over our life time
- from the brain \cite{wellermicro}. Precise details of the mechanism that causes AD are (largely) unknown  \cite{wellerperi}.  %Here we build a graph theoretic model that demonstrates the importance of symmetry of the cerebral arterial tree to the proliferation of AD.

Extracellular space in the brain contains interstitial fluid (ISF) which is produced by the blood and by-products of cell metabolism.  The extracellular spaces within the walls of cerebral blood vessels referred to as \emph{basement membranes} represent the perivascular pathways along which ISF drains out of the brain \cite{wellerperi,wellermicro,Rox}.  

One mechanism for the removal of A$\beta$ from the brain parenchyma is perivascular drainage, by which A$\beta$ within ISF enters the capillary basement membranes draining to the walls of arteries towards the surface of the brain. 

\begin{figure}[h]

              \centering
               \includegraphics[scale=0.6]{drainage.jpeg}
                \caption{Perivascular drainage of A$\beta$ along basement membranes.}\label{fig:1}
\end{figure}

With ageing and a certain genetic disposition soluble A$\beta$ is not eliminated from the brain, instead it is deposited in the walls of blood vessels as \emph{Cerebral Amyloid Angiopathy} (CAA) \cite{Rox,;wellerperi}. CAA may cause a blockage in the ISF drainage pathways resulting in an alteration of the composition of ISF in the brain parenchyma. This change in biochemical composition of the ISF leads to nerve cell death and Alzheimer's Disease. \cite{Rox}.   

\begin{figure}

              \centering
               \includegraphics[scale=0.15]{abeta.jpg}
                \caption{CAA in a cross-section of a leptomeningeal artery: the deposition of A$\beta$ is shown in red.}\label{figy:2}
\end{figure}

Susceptibility to CAA varies throughout the brain and vascular vessels.  In particular  
CAA  is most prominent in the occipital, temporal and frontal lobes and least prominent in the parietal lobe and the cerebellum %The leptomeningeal and cortical arteries are particularly prone to CAA whereas CAA is very rare in capillaries 
\cite{Preston}. We suspect that one reason for the differing unacceptability of CAA is the differing symmetry of the cerebral arterial tree.  High levels of symmetry have been shown to be advantageous in other networks.  For example Song \emph{et al.} found that a fractal biochemical annotation  network (a graph with a high level of symmetry) is more robust than a less symmetric graph \cite{Song}.  In order to test the hypothesis that symmetry effects susceptibility to CAA we design and implement a graph theoretic algorithm that models CAA.%and therefore need to make some relevant definitions from graph theory.  


\section{Background}

In Section \ref{sec:meth} we will describe an algorithm that models CAA.  This algorithm is constituted of two parts; a model of the anatomical structure of the perivascular drainage system and an algorithm that replicates accumulation of A$\beta$.  We will describe this model in the language of graph theory, reformulating accumulation of A$\beta$ as a process on a graph.      

\subsection{Graphs and Trees}
Graph theory has a rich mathematical history dating back to Leonard Euler and more recently graph theory, under the guise of the much ballyhooed \emph{Science of Networks}, has been applied to model diverse phenomena such as social networks, the world wide web, and the internet \cite{barabasi,bigg}.

A (undirected, unweighted) graph is a pair $G = (V(G),E(G))$ such that $V(G)$ and $E(G)$ are the vertices and edges of $G$ respectively. Every edge $e \in E(G)$ begins and ends at vertices $ v,w \in V(G)$. If an edge begins and ends at the same time we call that edge a \emph{loop}.  Conversely we say that two vertices are \emph{adjacent} if they are connected via an edge.

%\begin{ex}
 \definecolor{cff0000}{RGB}{255,0,0}
 \definecolor{c770d0c}{RGB}{119,13,12}
\definecolor{c30a3f9}{RGB}{48,163,249}
\begin{figure}[H]
\centering
\begin{tikzpicture}[y=0.80pt,x=0.80pt,yscale=-1, inner sep=0pt, outer sep=0pt, scale = 0.35]
  \path[cm={{1.64548,0.08392,-0.09385,1.47135,(-193.31641,-165.94688)}},draw=black,fill=c770d0c,fill
    opacity=0.000] (553.0000,211.3622)arc(0.000:180.000:72.500000 and
    76.000)arc(-180.000:0.000:72.500000 and 76.000) -- cycle;
  \path[shift={(259.0,392.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[shift={(-116.0,394.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[shift={(249.0,42.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[fill=black,line join=miter,line cap=butt,line width=0.800pt] (0,0)
    node[above right] (flowRoot4017) {};
  \path[xscale=1.004,yscale=0.996,fill=black] (421.98358,660.8728) node[above
    right] (text4025) {V3};
  \path[xscale=0.896,yscale=1.116,fill=black] (63.534481,597.77637) node[above
    right] (text4033) {V2};
  \path[xscale=0.817,yscale=1.224,fill=black] (514.15002,252.65466) node[above
    right] (text4037) {V1};
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (168.0000,641.3622) -- (382.0000,638.3622);
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (463.0000,550.3622) -- (461.0000,359.3622);
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (382.0000,309.3622) -- (137.0000,569.3622);

\end{tikzpicture}
\caption{A graph with 3 vertices, 4 edges and 1 loop.  The path 1-2-3 is a cycle}
\end{figure}
%\end{ex}
The degree, $\deg(v)$, of a vertex $v$ is the number of edges incident to $v$.  If $\deg(v) = 1$ then we say that $v$ (and the edge incident to $v$) is a  \emph{leaf}. A path is a sequence of consecutive edges and a cycle is a path beginning and ending at the same vertex that doesn't visit an edge more than once.  A \emph{tree} is  a connected graph (there exists a path between every pair of vertices) which admits no cycles or loops \cite{bela}.  

%\begin{ex}
 \definecolor{cff0000}{RGB}{255,0,0}
 \definecolor{c30a3f9}{RGB}{48,163,249}
\definecolor{cff0d0c}{RGB}{255,13,12}

\begin{figure}[H]
\centering




\begin{tikzpicture}[y=0.80pt,x=0.80pt,yscale=-1, inner sep=0pt, outer sep=0pt, scale = 0.35]
  \path[shift={(175.0,149.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[shift={(-111.0,507.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[shift={(174.0,503.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[shift={(435.0,490.0)},fill=c30a3f9]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[shift={(177.0,-157.0)},fill=cff0d0c]
    (285.7143,239.5050)arc(0.000:180.000:80.000000 and
    78.571)arc(-180.000:0.000:80.000000 and 78.571) -- cycle;
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (380.0000,163.3622) -- (382.0000,318.3622);
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (326.0000,450.3622) -- (326.0000,449.3622) -- (138.0000,685.3622);
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (382.0000,469.3622) -- (380.0000,663.3622);
  \path[draw=black,line join=miter,line cap=butt,line width=0.800pt]
    (444.0000,441.3622) -- (600.0000,669.3622);
  \path[fill=black,line join=miter,line cap=butt,line width=0.800pt] (0,0)
    node[above right] (flowRoot4017) {};
  \path[fill=black] (72,762.36218) node[above right] (text4025) {V3};
  \path[fill=black] (358,402.36218) node[above right] (text4033) {V2};
  \path[fill=black] (357,93.362183) node[above right] (text4037) {V1};
  \path[fill=black] (358,764.36218) node[above right] (text4041) {V4};
  \path[fill=black] (615,746.36218) node[above right] (text4045) {V5};

\end{tikzpicture}
\caption{Tree, $T$ with edges $\{(V1V2)(V2V3)(V2V4)(V2V5)\}$.  We may permute edges $\{ (V2V3)(V2V4)(V2V5)\}$ whilst preseriving adjacent vertices in 6 possible ways so $|\Sym(T)| = 6$. By assigning $V1$ to be the root of $T$ notice that $\lv(V1) = 0, \lv(V2) = 1, \lv(V3) = \lv(V4) = \lv(V5) = 2.$.  The vertices marked in blue represent an induced subtree of $T$, rooted at V2. 
}  
\end{figure}
%\end{ex}

\begin{rem}
One can formally calculate the symmetry of a mathematical object such as a graph or cube by identifying that object's \emph{group of symmetries}.  For example the group of (orientation preserving) symmetries of the cube consist of all possible rotations of the cube i.e. pick the cube up, rotate it in such a way that when you put it down it will look identical to the original cube.  Similarly, for a tree $T$ the group of symmetries, $\Sym(T)$, consists of all permutations of vertices/edges that preserve vertex adjacency. The number of possible legal permutations is written as $|\Sym(T)|$ and we say that a tree with a larger number of legal permutations is more\emph{symmetric} than a tree with a smaller symmetry group.  
\end{rem}

The vascular system comprises of a hierarchy of vessels: blood flows from arteries to arterioles to capillaries.  To reflect this orientation our model will incorporate a \emph{rooted} tree: a tree in which one vertex has been assigned the role of \emph{root}.  The \emph{level} of each vertex $v \in V(G)$ is the length of the shortest path from the root to $v$, we write this as $\lv(v)$.


\begin{rem}
 The assigned root vertex in our model will correspond to the point where A$\beta$ drains out of the cerebral vasculature and into the lymphatic system.  When we model a blockage in the perivascular system we will remove an edge from a rooted tree $T$ which results in a failure of drainage from all vessels that flow into that edge  - these vessels correspond to an \emph{induced subtree} of $T$.  In particular,  if the edge joining vertices $v,w \in V(T)$ is removed and (without loss of generality) $\lv(v) < \lv(w)$ then we will also remove the induced subtree rooted at $w$ from $T$.     
\end{rem}

Recall from Section \ref{sec:intro} the hypothesis that there exists correlation between a high degree of symmetry and network robustness. To gain some intuition into this hypothesis consider the following (extreme) example.  Let $T_1$ be the tree on 15 vertices depicted on the left and $T_{2}$ be the line of 15 vertices depicted on the right of Figure \ref{fig:silly} [below].  Since $|\Sym(T_{1})| = 128$ and that $|\Sym(T_{2})|$ = 2, $T_{1}$ is more symmetric than $T_{2}$.  

\begin{figure}[H]
\begin{tikzpicture}[scale = 0.6]
  [scale=0.9,auto=left,every node/.style={circle,fill=blue!20}]
  \node (n1) at (5.5,7) {1};
  \node (n2) at (2.5,5)  {2};
  \node (n3) at (8.5,5)  {3};
  \node (n4) at (1,3) {4};
  \node (n5) at (4,3)  {5};
  \node (n6) at (7,3)  {6};
\node (n7) at (10,3)  {7};
\node (n8) at (0,1)  {8};
\node (n9) at (2,1)  {9};
\node (n10) at (3,1)  {10};
\node (n11) at (5,1)  {11};
\node (n12) at (6,1)  {12};
\node (n13) at (8,1)  {13};
\node (n14) at (9,1)  {14};
\node (n15) at (11,1)  {15};

\node (n16) at (12,6)  {1};
\node (n17) at (12.5,2)  {2};
\node (n18) at (13,6)  {3};
\node (n19) at (13.5,2)  {4};
\node(n20) at (14,6)  {5};
\node (n21) at (14.5,2)  {6};
\node (n22) at (15,6)  {7};
\node (n23) at (15.5,2)  {8};
\node (n24) at (16,6)  {9};
\node (n25) at (16.5,2)  {10};
\node (n26) at (17,6)  {11};
\node (n27) at (17.5,2)  {12};
\node(n28) at (18,6)  {13};
\node (n29) at (18.5,2)  {14};
\node (n30) at (19,6)  {15};

  \foreach \from/\to in {n1/n2,n1/n3,n2/n4,n2/n5,n3/n6,n3/n7,n4/n8,n4/n9,n5/n10,n5/n11,n6/n12,n6/n13,n7/n14,n7/n15,n16/n17,n17/n18,n18/n19,n19/n20,n20/n21,n21/n22,n22/n23,n23/n24,n24/n25,n25/n26,n26/n27,n27/n28,n28/n29,n29/n30}
    \draw (\from) -- (\to);

\end{tikzpicture}
\caption{$T_{1}$ and $T_{2}$}\label{fig:silly}
\end{figure}
If we remove an edge at random from $T_{1}$ and also remove the  induced subtree adjacent to that edge the expected number of edges removed is:
\begin{equation}
1\frac{8}{14} + 3\frac{4}{14} + 7\frac{2}{14} = \frac{12}{7} 
\end{equation} 
If we remove an edge at random from $T_{2}$ and also remove the  induced subtree adjacent to that edge the expected number of edges removed is:
\begin{equation}
\frac{1}{14}\sum_{k=1}^{14}k = \frac{15}{2} > \frac{12}{7}
\end{equation}





% Each edge, $e_{u,v} \in E(G)$, has two endpoints $u,v \in V(G)$ and we say that $u$ and $v$ are \emph{adjacent} and that $endpoints(e) = \{u,v\}$.  We do not allow more than one edge between a pair of vertices or loops (edges with a single endpoint). The degree of any vertex $v$ is the number of edges $e$ such that $v \in endpoints(e)$. 

%A tree, $T$, is a graph such that the shortest path between any pair of vertices $u,v \in V(T)$ is unique.  For example the graph in Figure \ref{fig:3} is a tree. 
%\begin{figure}
%\begin{tikzpicture}
%  [scale=.8,auto=left,every node/.style={circle,fill=blue!20}]
%  \node (n6) at (1,10) {6};
%  \node (n4) at (4,8)  {4};
%  \node (n5) at (8,9)  {5};
%  \node (n1) at (11,8) {1};
%  \node (n2) at (9,6)  {2};
%  \node (n3) at (5,5)  {3};

%  \foreach \from/\to in {n6/n4,n5/n1,n2/n5,n2/n3,n3/n4}
%    \draw (\from) -- (\to);

%\end{tikzpicture}
% \caption{}\label{fig:3}
%\end{figure}

%A \emph{random recursive tree} (RRT), $T$, with vertices $V(T) = \{v_{1},\dots,v_{n}\}$ is a 
%labelled, rooted tree obtained by assigning a root vertex $v_{1}$ then adding $n-1$ vertices 
%one by one such that each new vertex is joined by an edge to a randomly and uniformly chosen 
%existing vertex. A random recursive $q$-ary tree is a labelled, rooted tree built in the same 
%way as a random recursive tree except each new vertex is attached uniformly at random to an 
%existing vertex that has outdegree less than $q$ \cite{varietiesofincreasintrees}.  We say that RRTs and random 
%recursive $q$-ary trees are \emph{increasing} trees.  

%Given an increasing tree $T_{n}$ on $n$ vertices labelled by the function 
%$\phi : V(T) \rightarrow \{1,2,\dots,n\}$ and a vertex $v \in V(T)$ then we can consider 
%$\tilde{T_{v}}$  which is the induced subtree with vertices, $v_{i}\in B(v)$ such that 
%$\phi(v_{i}) \geq \phi(v)$. 

%Given some tree $T$ we can formally measure how \emph{symmetric} that tree is by calculating 
%the number of permutations of the vertices of that graph which preserves adjacent vertices.  
%We call the set of all these permutations, $Aut(T)$, the \emph{automorphism group} of $T$ and 
%he number of allowed permutations, $|Aut(T)|$ is the size of the automorphism group.  

%\begin{ex}
%Consider the following tree with 14 vertices.  
%\begin{figure}[H]%
%\centering
%\begin{tikzpicture}
%  [scale=0.8,auto=left,every node/.style={circle,fill=sotonblue!20}]

%  \node[style={circle,fill=red!100}] (n1) at (7,5) {1};
%  \node (n2) at (5,5)  {2};
%  \node[style={circle,fill=red!100}] (n3) at (9,8)  {3};
%  \node (n4) at (3,2) {4};
%  \node[style={circle,fill=red!100}] (n5) at (10,5)  {5};
%  \node (n6) at (1,1)  {6};
%  \node (n7) at (1,3)  {7};
%  \node (n8) at (2,5)  {8};
%  \node[style={circle,fill=red!100}] (n9) at (9,2)  {9};considering
%  \node (n10) at (3,8)  {10};
%  \node (n11) at (1,9)  {11};
%  \node (n12) at (1,7)  {12};
%  \node (n13) at (0,4)  {13};
%  \node (n14) at (0,6)  {14};
%  \foreach \from/\to in {n1/n2,n1/n3,n1/n5,n1/n9,n2/n4,n2/n8,n2/n10,n10/n11,n10/n12,n8/n14,n8/n13,n4/n7,n4/n6}
%    \draw (\from) -- (\to);
%\end{tikzpicture}
%\caption{}\label{fig2}
%\end{figure}
%The red vertices in Figure \ref{fig2} indicate an induced subtree $\tilde{T}_{v_{1}}$.  
%Any permutation of the red vertices $v_{3},v_{5}$ and $v_{9}$, makes a contribution to $Aut(T)$ %for example the following is a valid permutation of these 
%vertices.
%\begin{align*}
% 3 \rightarrow 5\\
% 5 \rightarrow 3\\
% 9 \rightarrow 9 
%\end{align*}
%Note that after the above permutation all three vertices remain adjacent to $v_{1}$.  There are $3! = 6$
 %distinct such permutations. The blue vertices in Figure \ref{fig2} highlight an extended 
%symmetric induced subtree, 
%$\tilde{T}_{v_{2}}$.  We can permute any of the pairs $\{v_{6},v_{7}\}, \{v_{11},v_{12}\}$ 
%and $\{v_{13},v_{14}\}$ and we can permute the longer branches.  For example the following 
%is a valid (adjacency preserving) permutation:
%\begin{align*}
% 4\rightarrow 8 \\
%6 \rightarrow 13\\
%7 \longrightarrow 14\\
%8 \rightarrow 4\\
%13 \rightarrow 7\\
%14 \rightarrow 6
%\end{align*}
%Where every other vertex is fixed.  There are $X$ possible valid permutations of the blue 
%vertices, therefore $|Aut(T_{14})| = 6 \times X = 6X$
%\end{ex}

%ADD EXAMPLE
%\begin{tikzpicture}
%  [scale=.8,auto=left,every node/.style={circle,fill=blue!20}]
%  \node (n1) at (6,10) {1};
%  \node (n2) at (6,6)  {2};
%  \node (n3) at (2,2)  {3};
%  \node (n4) at (10,2) {4};
  

  %\foreach \from/\to in {n1/n2,n2/n3,n2/n4}
%    \draw (\from) -- (\to);

%\end{tikzpicture}

%\begin{figure}[H]
%
%              \centering
%              \includegraphics[scale=0.3]{bifir.jpg}
%                \caption{Perivascular drainage of A$\beta$.}
%\end{figure}
%\subsubsection{Anatomical Data}\label{sec:ana}

%In order to build an effective model of CAA it is necessary to include relevant anatomical data such as the  length
%and radii of arterial vessels and the expected number of branching points.     


%One can formally calculate how symmetric an object, such as a graph or a cube, is by identifying its \emph{symmetry group}.




\subsection{Anatomical data}\label{sec:ana}

In order to build an effective model of CAA we will incorporate relevant anatomical data such as arterial length, branching and the radius of vessels \footnote{  There is  a great deal of disagreement and ambiguity in the literature pertaining to arterial vessel segments and branching points \cite{Zamir}.  We will use the definitions given by Cassot \emph{et al.} \cite{Cassot}} 
Cassot \emph{et al.} conducted a detailed analysis of the cerebral vasculature which has formed the basis of numerous numerical analyses \cite{grinberg,francis,risser}. Cassot \emph{et al.} found that 98\% of branching in the cerebral cortex is bifurcation and there are approximately  300 branching points \cite{Cassot}. 

%Murray's principle of minimization of operational cost states that the cost of operation of
% physiological systems tends to a minimum.  One consequence of Murray’s principle is referred 
%to as Murray's law which states that for $2$ daughter branches $d_{1}$ and $d_{2}$ from a 
%common parent arterial vessel, $p$: 

At an arterial bifurcation point with parent vessel $p$ and daughter vessels $d_{1}$ and $d_2$ Murray's law \cite{Murray} states that:

\[r_{p}^{3} = r_{d_{1}}^{3} + r_{d_{2}}^{3}\]
where $r_{p}$ is the radius of $p$ and $r_{d_{1}},r_{d_{2}}$ are the radii of $d_{1}$ and 
$d_{2}$ respectively.
Experimental evidence has shown that Murray's law is a good approximation for 
arterial vessels \cite{Zamir,cohn}.

Murray's law describes the relationship between certain bifurcating  
\emph{cylindrical vessels}, however, we will model the cerebral perivascular pathways as \emph{annular prisms}.  Therefore we will adjust Murray's law to describe 
the relationship between parent and child annular prisms. In addition we assume that the width of the perivascular space, $\epsilon$, is the same for any vessel from capillary to
 artery. Since the notion of radius is more 
complicated for an annular prism we reformulate Murray's law in terms of 
cross-sectional area.   


In addition we assume that the width of the perivascular space, $\epsilon$ is the same for any vessel from capillary to
 artery (the walls of cerebral capillaries consist of one fused layer of basement membrane which is approximately 150 nm in thickness).  So let the parent vessel have radius $r_{p} = r_{p}' + \epsilon$ and the two 
daughter vessels have radii $r_{d_i} = r_{d_i}' + \epsilon$ for $i = 1,2$.

%insert diagram here

\begin{lem}[Murray's law for annular prisms]
 \[A_p = \pi\left(\epsilon^{2} + 2\epsilon \left(\left( \frac{A_{d_{1}} + \pi\epsilon^{2}}{2\epsilon\pi} \right)^{3} + \left( \frac{A_{d_{2}} + \pi\epsilon^{2}}{2\epsilon\pi} \right)^{3}\right)^{\frac{1}{3}}\right)\]
where $A_p$ is the cross-sectional area of the parent vessel and $A_{d_{1}}$ and $A_{d_{2}}$ are the cross-sectional areas of the two daughter vessels at a bifurcation.
\end{lem}
\begin{proof}
The relationship between the cross-sectional area, $A_{X}$ of any vessel and the radius, $r_{X}$ 
of that vessel is given by the formulae:
\begin{align*}
 A_{X} &= \pi((r_{X}' + \epsilon)^{2} - r_{X}'^{2})\\
 &= \pi(\epsilon^{2} + 2\epsilon r_{X}')\\
 r_{X}' &= \frac{A_{X} - \pi\epsilon^{2}}{2\epsilon\pi}\\
 r_{X} &=  \frac{A_{X} - \pi\epsilon^{2}}{2\epsilon\pi} + \epsilon \\
 &= \frac{A_{X} + \pi\epsilon^{2}}{2\epsilon\pi}
\end{align*}

By combining the above equations we find that the cross-sectional area of the parent
 vessel, $A_{p}$, is given by:

\begin{align*}
A_{p} &= \pi(\epsilon^{2} + 2\epsilon r_{p}) \\
&= \pi\left(\epsilon^{2} + 2\epsilon (r_{d_{1}}^{3} + r_{d_{2}}^{3})^{\frac{1}{3}}\right)\\
&= \pi\left(\epsilon^{2} + 2\epsilon \left(\left( \frac{A_{d_{1}} + \pi\epsilon^{2}}{2\epsilon\pi} \right)^{3} + \left( \frac{A_{d_{2}} + \pi\epsilon^{2}}{2\epsilon\pi} \right)^{3}\right)^{\frac{1}{3}}\right)
\end{align*}
\end{proof}
%link to aneurysms etc.






%precise definition of a node and a branch



%\subsection{Graph Theory}\label{trees} 
% \cite{Bela} 
%and \cite{varietiesofincreasintrees}.
%Graph Theory has been an established area of discrete mathematics since 1736 when Euler 
%solved the famous question regarding the bridges of K\"{o}nigsberg.  More recently, in the 
%1940s and 50s Erd\H{o}s and R\'{e}nyi laid the foundations of the theory of random graphs 
%seeking to answer fundamental questions about the nature of ``most'' graphs. Random graphs 
%have been studied for their own sake and have been used to model a diverse set of real-world 
%networks from the world wide web to the metabolism of \emph{E. coli} \cite{barabasi}. Recently the advent of the world wide web and the accompanying %symbiotic?
%cheap and powerful computational power has led to a re-emergence of  
%random graph theory under the guise of ``Network Science''. 
%Steal from your summer project especially references.
%exactly which type of trees do we mean? - see one of the papers on your desk.  


\section{Method}\label{sec:meth}

In this section we will describe the algorithm we designed to replicate CAA \footnote{This algorithm was implemented using the numerical modelling program \emph{matlab} \cite{matlab}}.  This algorithm has three constituent parts:
\begin{itemize}
\item[(i)] Generate 50 random rooted binary (each vertex has degree less than 4) trees $\mathcal{T} = \{ T_1,T_2,\dots,T_{50}\}$.
\item[(ii)]Calculate the order of the symmetry group of each tree using the graph isomorphism program \emph{nauty} \cite{nauty}.
\item[(iii)] Replicate CAA by removing edges $e \in E(T_i)$. %of according to a predetermined probability model.
\end{itemize} 
%This program was then run 50 times and we investigated the relationship between $|Aut(T_{q}^{2})|$ and $\tau_{\frac{1}{2}}$.   

In accordance with the anatomical survey paper by Cassot \emph{et al.} discussed in Section \ref{sec:ana} each rooted binary tree was generated with $300$ vertices.  Each edge $e \in E(T_i)$ was associated with an annular prism and assigned a volume $\vol(e)$.   Leaf  edges were defined to have volume 1 and subsequent edges were given a volume consistent with Murray's law for annular prisms.  The \emph{initial} volume of each tree $T_i$ was defined to be 
\[\Vol(T_i) =  \sum_{e \in E(T_i)} \vol(e)\]

%We define the cross-sectional area of a leaf edge (capillary) to be one and then every other edge's cross-sectional area can be derived from Murray's law adjusted for annular prisms.  We define the length of every vessel to be one so now we can make sense of the volume, $Vol(e)$, of any edge $e \in E(T_{300}^{2})$. 
%and  $q=2$.  
%We used the graph isomorphism program \emph{nauty} \cite{nauty} to calculate the size of the automorphism group of each tree.  
The process of edge removal proceeds as follows:  at time $t=0$ we set $T_{i}(0) = T_{i}$ (our randomly generated rooted binary tree).  At subsequent times  $t = 1,2,\dots$ we associated a probability $0<P_{t}\leq 1$, that edge $e$ was to be removed at time $t$, with every edge $e \in E(T(t))$. If edge $e$ was removed then the induced subtree rooted at the endpoint of $e$ greatest distance from the root of $T_i$ was also removed to form $T_i(t)$.   

The volume of $T_i$ at time $t$ was defined to be $\Vol_{t}(T_i) = \sum_{e \in E(T_i(t))} \vol(e)$.  We then defined concentration: 
\[C(t) = \frac{\Vol(T_i}{\Vol_{t}(T_i)}.\]
We can now define %$P = p.C(t)$ where if $pC(t)<1$ and $P = 1$ if $p(C(t)) \geq 1$ for some $0<p<1$.     

\[P_t = \begin{cases} p.C(t) &\mbox{if } p.C(t) <1 \\
1 & \mbox{otherwise }  \end{cases} \text{  where   } 0<p<1 \]

Finally, we recorded the time, $\tau_{i}$, taken to remove half of the edges from each $T_{i}$ (henceforth we will refer to $\tau_i$ as the \emph{half-life}). 
 
\section{Results}  


%We generated 50 random recursive binary trees.

%A relatively crude way of estimating the resilience of a tree to the deletion process outlined in Section \ref{sec:meth} is to calculate the time, $\tau_{\frac{1}{2}}$,  it takes for half the vertices to be removed.  In the brain this would be a catastrophic loss of perivascular pathways and reflects the advanced stages of CAA.  

%For each of the 50 random recursive binary trees $\mathcal{T_{i}}$ for $i=1,2,\dots,50$. % and for each $T_{300}^{2} \in \mathcal{T}$ we calculated $|Aut(T_{300}^{2})|$.  
%We calculated the median, $\phi$, of the automorphism group sizes and split  $\mathcal{T}$  into two subsets.

For each tree $T_i$ we calculated the order of the symmetry group $|\Sym(T_i)|$ and the minimum time, $\tau_i$, taken for at least half of the edges $e \in E(T_i)$  to be removed from $T_i$.  We further calculated the median order of symmetry group, $\phi = $, and partitioned $\mathcal{T}$ into two subsets as follows: 

\[\mathcal{T}_{1} = \{T_i \in \mathcal{T} : |\Sym(T_i)| < \phi\} \text{      and      }\mathcal{T}_{2} = \{T_i \in \mathcal{T} : |\Sym(T_i)| <geq \phi\} \]

%We then calculated the means $\mu_{i}$ of the $\tau_{\frac{1}{2}}$ such that $T \in \mathcal{T}_{i}$ for $i= 1,2$. 

We also calculated the mean values, $\mu_j$ ($j = 1,2$) of $\tau_i$ for trees in $\mathcal{T}_j$ for $j = 1,2$:
\[\mu_j = \frac{\sum_{T_i \in \mathcal{T}_j}}{|\mathcal{T}_j|}\]

Figure \ref{t12} shows the $\mu_j$ corresponding to the $\mathcal{T}_j$

\begin{figure}[H]

              \centering
               \includegraphics[scale=0.5]{half.jpeg}
                \caption{Mean time for $\frac{1}{2}$ edges to be removed for high and low values of $|\Sym(T_i)|$}\label{t12}
\end{figure}

%For further corroboration we also defined $\tau_{\frac{2}{3}}$ and the corresponding $\mu_{1}'$ and $\mu_{2}'$.  

%\begin{figure}[H]

              %\centering
              %\includegraphics[scale=0.25]{twot.pdf}
              %  \caption{$\tau_{\frac{2}{3}}$.}\label{t23}
%\end{figure}

It is clear that the trees with a larger symmetry group had a much greater mean half-life.

\subsection{Discussion}

In order to place our results back into a medical context recall that the edges and vertices of each tree $T_i$ correspond to arterial vessels and branching points respectively.  The half-life, $\tau_i$ associated with each tree describes the rate at which drainage pathways become obstructed i.e. the rapidity of the onset of CAA.  

In order to build an effective model of CAA it was necessary to make several simplifying assumptions.  We defined the probability that an edge was removed in terms of the concentration of A$\beta$ but the distribution of deposition of A$\beta$ in a real arterial vessel is complex and not fully understood \cite{yow}.  Similarly, our model of CAA was discrete, i.e. an edge either allowed free flow of ISF or was blocked but in reality CAA is a gradual process.  In a future model of CAA we would recommend variable edge flow. Ambrose has shown that the brain undergoes angiogenisis which could be reflected by including a new random parameter which governs the introduction of edges in our algorithm \cite{ambrose}.   Modelling basement membranes as annular prisms does not take into account the tortuous routes of perivascular drainage therefore one might also include a tortuosity parameter in a more refined model.  Finally, we could model arteriosclerosis (suspected to be a major contributing factor to CAA \cite{yow,
weller2002})  by 
introducing a monotonically decreasing radial function. 

 Our results suggest that a more symmetric cerebral arterial tree could indicate a higher degree of robustness to CAA, however we stress that ours is a very rudimentary model.  Further evidence of this correlation could be found by experiment examining the relationship between highly symmetric areas of the brain and the extent to which those areas are affected by CAA. 



%The simplifications and assumptions underlying the model include the assumption that the total rate of removal of ISF remains constant, even after the blockage of basement membranes. We also defined the probability, $P_t$ that an edge is removed solely in terms of the concentration of A$\beta$ in the basement membrane at time $t$.  In order to improve the accuracy of our model we could make several modifications.

%Further, we could refine the process of edge removal by allowing a variable flow along each edge.  We could also attempt to reflect the fact that modelling the basement membranes as annular prisms does not take into account the tortuous routes of perivascular drainage.  Finally, we could also model the stiffening of arteries over time  by introducing a radial function that monotonically decreases.


%High levels of symmetry have been shown to be advantageous in other networks.  For example Song \emph{et al.} create a mathematical model to study the evolution of a biochemical annotation network. They show that a fractal network (a graph with a high level of symmetry) is more robust  i.e. the removal of many nodes has minimal effect on the shortest paths \cite{Song}.  

%To gain some intuition as to why this is the case consider the following extreme example.  Let $T_{1}$ be the complete tree on 15 vertices and let $T_{2}$ be a line of 15 vertices as seen in Figure \ref{fig:silly}.  Notice that $|\Sym(T_{1})| = BIG$ and that $|\Sym(T_{2}|$ = 2 so $T_{1}$ is much more symmetric than $T_{2}$.  

%\begin{figure}[H]
%\begin{tikzpicture}[scale = 0.6]
%  [scale=0.9,auto=left,every node/.style={circle,fill=blue!20}]
%  \node (n1) at (5.5,7) {1};
%  \node (n2) at (2.5,5)  {2};
%  \node (n3) at (8.5,5)  {3};
%  \node (n4) at (1,3) {4};
%  \node (n5) at (4,3)  {5};
%  \node (n6) at (7,3)  {6};5\node (n7) at (10,3)  {7};
%\node (n8) at (0,1)  {8};
%\node (n9) at (2,1)  {9};
%\node (n10) at (3,1)  {10};
%\node (n11) at (5,1)  {11};%\node (n12) at (6,1)  {12};
%\node (n13) at (8,1)  {13};
%\node (n14) at (9,1)  {14};
%\node (n15) at (11,1)  {15};

%\node (n16) at (12,6)  {1};
%\node (n17) at (12.5,2)  {2};
%\node (n18) at (13,6)  {3};
%\node (n19) at (13.5,2)  {4};
%\node(n20) at (14,6)  {5};
%\node (n21) at (14.5,2)  {6};
%\node (n22) at (15,6)  {7};
%\node (n23) at (15.5,2)  {8};
%\node (n24) at (16,6)  {9};
%\node (n25) at (16.5,2)  {10};
%\node (n26) at (17,6)  {11};
%\node (n27) at (17.5,2)  {12};
%\node(n28) at (18,6)  {13};
%\node (n29) at (18.5,2)  {14};
%\node (n30) at (19,6)  {15};

  %\foreach \from/\to in %{n1/n2,n1/n3,n2/n4,n2/n5,n3/n6,n3/n7,n4/n8,n4/n9,n5/n10,n5/n11,n6/n12,n6/n13,n7/n14,n7/n15,n16/n17,n17/n18,n18/n19,n19/n20,n20/n21,n21/n22,n22/n23,n23/n24,n24/n25,n25/n26,n26/n27,n27/n28,n28/n29,n29/n30}
  %  \draw (\from) -- (\to);

%\end{tikzpicture}
%\caption{$T_{1}$ and $T_{2}$}\label{fig:silly}
%\end{figure}
%f we remove an edge at random from $T_{1}$ and also remove the  induced subtree adjacent to that edge the expected number of edges removed is:
%\begin{equation}
%1\frac{8}{14} + 3\frac{4}{14} + 7\frac{2}{14} = \frac{12}{7} 
%\end{equation} 
%If we remove an edge at random from $T_{2}$ and also remove the  induced subtree adjacent to that edge the expected number of edges removed is:
%\begin{equation}
%\frac{1}{14}\sum_{k=1}^{14}k = \frac{15}{2} > \frac{12}{7}
%\end{equation}

%One could argue that our results were the result of weak assumptions regarding concentration, however we yielded a similar result with a simplified experiment.  We built 50 random recursive binary trees $\mathcal{T}$ in the same way and set $P$ to be constant rather than a function of concentration.  We split $\mathcal{T}$ into $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ and found the mean hitting times $\mu_{1}$ and $\mu_{2}$.  Again we found that $\mu_{1} < \mu_{2}$.  

\section{Conclusion and Clinical Implications}

We have demonstrated that it is likely that there is correlation between symmetry of the cerebral vascularture and lower risk of proliferation of CAA.  

\bibliographystyle{h-physrev3.bst}
%\bibliographystyle{plain}

\bibliography{./medicine}{}

\end{document}
